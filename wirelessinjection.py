from scapy.all import *

# Prompt user for input values
frame_type = int(input("Enter the Frame Type for Injection (0-Management, 1-Control, 2-Data): "))

if frame_type == 0:
    # Management frames
    print("Management frames Subtypes:")
    print("0: Association Request")
    print("1: Association Response")
    print("2: Reassociation Request")
    print("3: Reassociation Response")
    print("4: Probe Request")
    print("5: Probe Response")
    print("6: Beacon")
    print("7: Announcement Traffic Indication Map (ATIM)")
    print("8: Disassociation")
    print("9: Authentication")
    print("10: Deauthentication")
    print("11: Action")
elif frame_type == 1:
    # Control frames
    print("Control frames Subtypes:")
    print("8: Block Acknowledgment Request")
    print("9: Block Acknowledgment")
    print("10: Power Save Poll")
    print("11: Request to Send (RTS)")
    print("12: Clear to Send (CTS)")
    print("13: Acknowledgment (ACK)")
    print("14: Content (Contention-Free)")
    print("15: Content (Contention-Free + Acknowledgment)")
elif frame_type == 2:
    # Data frames
    print("Data frames Subtypes:")
    print("0: Data")
    print("1: Data + CF-Ack (Contention-Free Acknowledgment)")
    print("2: Data + CF-Poll (Contention-Free Poll)")
    print("3: Data + CF-Ack + CF-Poll (Contention-Free Acknowledgment and Poll)")
    print("4: Null Data")
    print("5: CF-Ack (Contention-Free Acknowledgment)")
    print("6: CF-Poll (Contention-Free Poll)")
    print("7: CF-Ack + CF-Poll (Contention-Free Acknowledgment and Poll)")
else:
    print("Invalid frame type!")
#Frame Packet Crafting Options
subtype = int(input("Enter the Subtype: "))
destination_mac = input("Enter the Destination MAC Address: ")
source_mac = input("Enter the Source MAC Address: ")
bssid = input("Enter Router BSSID:")
packet_count = int(input("Enter the Packet Counts to Send: "))
packet_interval = float(input("Enter the Packet Interval (Per Second): "))
interface = input("Enter the Wireless Interface Name: ")

  # Additional Options
FCfield = int(input("Enter the Frame Control (FC) field value (integer): ") or 0)
ID = int(input("Enter the Identifier (ID) field value (integer): ") or 0)
sec_destinationmac = input("Enter the fourth address (if applicable): ") or None
SC = int(input("Enter the Sequence Control (SC) field value (integer): ") or 0)

     
dot11 = Dot11(type=frame_type, subtype=subtype, addr1=destination_mac, addr2=source_mac, addr3=bssid,
                   FCfield=FCfield, ID=ID, addr4=sec_destinationmac, SC=SC)
# Combine frame and payload
packet = RadioTap() / dot11 

# Send the packet
print("Injecting Packets")
if sendp(packet, iface=interface, count=packet_count, inter=packet_interval) == packet_count:
    print('Packet Injection Successful')
else:
    print('Packet Injection Failed')

